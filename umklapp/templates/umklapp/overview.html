{% extends "umklapp/base.html" %}
{% load bootstrap %}
{% block title %}Neue Geschichte starten{% endblock %}

{% block content %}
<meta http-equiv="refresh" content="10">
<div class="container">
<h2>Willst Du eine neue Geschichte starten?</h2>
<a href="{% url 'new_story' %}">Neue Geschichte starten</a><p/>
<h2>Laufende Geschichten</h2>
{% if running_stories %}
  <ul>
	  {% for s in running_stories %}
	    <li>
			„{{ s.title }}“ ({{ s.parts.count }} Sätze):
			{% if s.waiting_for = user %}
			  <a class="btn btn-primary btn-sm" href="{% url 'continue_story' story_id=s.id %}">fortsetzen</a>
			{% else %}
			  wartet auf {{ s.waiting_for }}...
			{% endif  %}
			<form style="display:inline" method="post" action="leave_story">
				{% csrf_token %}
				<input type="hidden" name="story_id" value="{{ s.id }}"/>
				<button type="submit" class="btn btn-default btn-sm">verlassen</button>
			</form>
			{% if specialpowers or s.waiting_for = user %}
			<form method="post" action="skip">
				{% csrf_token %}
				<input type="hidden" name="story_id" value="{{ s.id }}"/>
				<button type="submit" class="btn btn-default btn-sm">&uuml;berspringen</button>
			</form>
			{% endif %}
	     </li>
	  {% endfor %}
  </ul>
{% else %}
<p>Es gibt gerade keine laufenden Geschichten.</p>
{% endif %}
<h2>Beendete Geschichten </h2>
{% if finished_stories %}
  <ul>
	  {% for s in finished_stories %}
	    <li>„{{ s.title }}“: <a href="{% url 'show_story' story_id=s.id %}">lesen</a></li>
	  {% endfor %}
  </ul>
{% else %}
<p>Es gibt gerade keine fertigen Geschichten.</p>
{% endif %}
</div>
{% endblock %}
